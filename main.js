"use strict";(self.webpackChunkbattleship=self.webpackChunkbattleship||[]).push([[179],{308:(e,t,a)=>{const n={loadCard:()=>{document.getElementById("app").appendChild((()=>{const e=document.createElement("section"),t=document.createElement("div");return e.className="start-card",t.className="content-container",e.appendChild((()=>{const e=document.createElement("h1");return e.textContent="BATTLESHIP",e})()),e.appendChild((()=>{const e=document.createElement("form");e.className="name-form";const t=document.createElement("input");t.type="text",t.id="name-input",t.className="name-input",t.placeholder="Captains's Name";const a=document.createElement("span");return a.className="input-border",e.appendChild(t),e.appendChild(a),e})()),e.appendChild((()=>{const e=document.createElement("button");e.id="play-button",e.className="play-button";const t=document.createElement("span");return t.className="text-play-button",t.textContent="ENTER ARENA",e.appendChild(t),e})()),e})())}},s=(()=>{const e=()=>{const e=document.createElement("div");e.className="field-container",e.id="field-container";for(let t=0;t<10;t+=1)for(let t=0;t<10;t+=1){const t=document.createElement("div");t.className="field",e.appendChild(t)}return e};return{deleteContent:()=>{document.getElementById("app").replaceChildren("")},createMap:t=>{const a=document.createElement("div");return a.id=`board-${t}`,a.classList.add("board",t),a.appendChild((()=>{const e=document.createElement("div");return e.classList="numberx-container",e.id="numberx-container",[0,1,2,3,4,5,6,7,8,9].forEach((t=>{const a=document.createElement("div");a.classList="number",a.textContent=t,e.appendChild(a)})),e})()),a.appendChild((()=>{const e=document.createElement("div");return e.classList="numbery-container",e.id="numbery-container",[0,1,2,3,4,5,6,7,8,9].forEach((t=>{const a=document.createElement("div");a.classList="number",a.textContent=t,e.appendChild(a)})),e})()),a.appendChild(e()),a},createBoard:e,getCoordinates:e=>[parseInt(e/10,10),e%10],getIndex:(e,t)=>9*e+t,nearestTen:e=>{for(;e%10!=0;)e+=1;return e},randomTen:()=>Math.floor(5*Math.random())+1}})(),r=a.p+"img/BattleshipX90674ad440b4a45324a8.svg",c=a.p+"img/CarrierXd9abd65e3052cdfaddc5.svg",o=a.p+"img/CruiserX59963e708f4ca8db81ac.svg",d=a.p+"img/DestroyerX636a499a990bcbff4109.svg",i=a.p+"img/SubmarineXe75582b7a7e2f393394b.svg",l=(e,t)=>{let a=!1,n=0,s=!1;const r=()=>{a=!0};return{length:t,hit:()=>{n+=1,n===t&&r()},getName:()=>e,sunk:r,name:e,getLength:()=>t,getHits:()=>n,sunkStatus:()=>a,found:()=>s,gotFound:()=>{s=!0},resetFound:()=>{s=!1}}},u=e=>{const t=(()=>{const e=new Array(10).fill("x").map((()=>new Array(10).fill("x"))),t=[];let a=[],n="X";const s={name:"",length:0},r=e=>a.filter((t=>t.getName()===e))[0],c=e=>{switch(e.getName()){case"carrier":a.push(l("carrier",5));break;case"battleship":a.push(l("battleship",4));break;case"cruiser":a.push(l("cruiser",3));break;case"submarine":a.push(l("submarine",3));break;default:a.push(l("destroyer",2))}},o=(e,t,a)=>e>t-a;return{board:e,placeX:(t,a,n)=>{let s=t.getLength();const r=[];if(o(s,e.length,n))return!1;for(let t=n;t<e.length;t++){if("x"!==e[a][t])return!1;if(r.push([a,t]),s-=1,0===s)break}return r.forEach((a=>{const[n,s]=a;e[n][s]=`${t.getName()}X`})),c(t),!0},placeY:(t,a,n)=>{let s=t.getLength();const r=[];if(o(s,e.length,a))return!1;for(let t=a;t<e.length;t++){if("x"!==e[t][n])return!1;if(r.push([t,n]),s-=1,0===s)break}return r.forEach((a=>{const[n,s]=a;e[n][s]=`${t.getName()}Y`})),c(t),!0},receiveAttack:(a,n)=>{((a,n)=>{switch(e[a][n]){case"carrierX":case"carrierY":r("carrier").hit(),e[a][n]="hit";break;case"battleshipX":case"battleshipY":r("battleship").hit(),e[a][n]="hit";break;case"cruiserX":case"cruiserY":r("cruiser").hit(),e[a][n]="hit";break;case"submarineX":case"submarineY":r("submarine").hit(),e[a][n]="hit";break;case"destroyerX":case"destroyerY":r("destroyer").hit(),e[a][n]="hit";break;default:e[a][n]="miss",t.push([a,n])}})(a,n)},getShip:r,missedTarget:t,allSunk:()=>5===a.filter((e=>!0===e.sunkStatus())).length,getBoard:()=>e,shipOnDrag:s,getshipOnDrag:()=>s,setShipOnDrag:e=>{s.name=e.name,s.length=e.length},getFleet:()=>a,setFleetEmpty:()=>{a=[]},axis:n,getAxis:()=>n,setAxisX:()=>{n="X"},setAxisY:()=>{n="Y"},setAllShipsNotFound:()=>a.forEach((e=>e.isFound=!1)),areAllShipsFound:()=>5===a.length}})();let a=0,n=e;const s=()=>n,r=(e,a)=>"x"===t.board[e][a],c=()=>Math.floor(10*Math.random());return{play:(e,n)=>{"cpu"!==s().toLowerCase()?r(e,n)&&(t.receiveAttack(e,n),a+=1):(()=>{let e=!0;for(;e;){const n=c(),s=c();r(n,s)&&(e=!1,t.receiveAttack(n,s),a+=1)}})()},getTurn:()=>a,getName:s,setName:e=>{n=e},board:t,getMap:()=>t,autoPlace:()=>{const e=["battleship","carrier","cruiser","destroyer","submarine"],a=[4,5,3,2,3],n=t.getMap();for(;e.length;){const t=["X","Y"][Math.floor(2*Math.random())];let s=!1;const r=c(),o=c();s="X"===t?n.placeX(l(e[0],a[0]),r,o):n.placeY(l(e[0],a[0]),r,o),s&&(e.shift(),a.shift()),console.log(n)}}}},m=(()=>{const e=()=>{const e=u("Captain"),t=u("cpu");return{getCPU:()=>t,getPlayer:()=>e,player:e,cpu:t}},t=e(),a=()=>t;return{initializeGame:e,state:t,getState:a,setPlayerName:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Captain";return a().getPlayer().setName(e)}}})(),p=(()=>{const e=(e,t)=>{const a=t.boardElement.slice(0,t.boardElement.length-1),n=player.getMap().getShip(a);if(n.found())return;n.found();const s=n.getLength(),[l,u]=["10%",10*s+"%"],[m,p]=[10*t.i+"%",10*t.j+"%"];let h="rotate(0deg)";"Y"===t.boardElement.at(-1)&&(h="rotate(90deg) translate(0, -100%)");const g=document.createElement("div");g.style.position="absolute",g.style.zIndex="-1",g.style.top=m,g.style.left=p,g.style.width=u,g.style.height=l,g.style.transform=h,g.style.transformOrigin="top left";const b=document.createElement("img");b.src=(e=>{let t;switch(e){case"battleshipX":t=r;break;case"carrierX":t=c;break;case"cruiserX":t=o;break;case"destroyerX":t=d;break;case"submarineX":t=i;break;default:t=""}return t})(a),b.style.height="95%",b.style.aspectRatio=`${s}/1`,g.appendChild(b),t.board.appendChild(g)};return{loadShipsOnBoard:e,loadFleet:t=>{const a=m.state.getPlayer().getMap(),n=a.getBoard();console.log(n);for(let s=0;s<n.length;s+=1)for(let r=0;r<n[0].length;r+=1)"x"!==n[s][r]&&e(n[s][r],{map:a,board:t,i:s,j:r})}}})(),h=p,g=(()=>{const e=(e,t)=>{const a=m.state.getPlayer().getMap();"x-button"===e.is?a.setAxisX():a.setAxisY(),e.classList.add("selected"),t.classList.remove("selected")};function t(){}const a=()=>{(()=>{const t=document.getElementById("x-button"),a=document.getElementById("y-button");t.addEventListener("click",(()=>e(t,a))),a.addEventListener("click",(()=>e(a,t)))})(),(()=>{const e=document.getElementById("reset-button"),a=document.getElementById("continue-button"),n=m.state.getPlayer().getMap().getBoard();e.addEventListener("click",(()=>(e=>{const t=document.getElementById("field-container");var a;!function(){const e=m.state.getPlayer().getMap();document.getElementById("fleet-setup").childNodes.forEach((e=>e.classList.remove("hidden"))),e.getFleet().forEach((e=>e.resetFound())),e.setFleetEmpty()}(),function(e){for(let t=0;t<e.length;t+=1)for(let a=0;a<e[0].length;a+=1)e[t][a]="x"}(e),(a=t).style.backgroundImage="",a.style.backgroundSize="",a.style.backgroundPosition=""})(n))),a.addEventListener("click",t)})()},n=()=>{const e=document.createElement("div");return e.className="board-fleet-container",e.appendChild(s.createMap("setup")),e.appendChild((()=>{const e=document.createElement("section");return e.id="fleet-setup",e.className="fleet-setup",["batttleship","carrier","cruiser","destroyer","submarine"].forEach((t=>{const a=(e=>{const t=document.createElement("button"),a=document.createElement("div"),n=document.createElement("img"),s=document.createElement("p");switch(t.className="ship-card",a.className="ship-content",n.className="ship-image",s.className="ship-name",e){case"carrier":t.dataset.shipName="carrier",t.dataset.shipLength=5,n.src=c,s.textContent="Carrier";break;case"cruiser":t.dataset.shipName="cruiser",t.dataset.shipLength=3,n.src=o,s.textContent="Cruiser";break;case"destroyer":t.dataset.shipName="destroyer",t.dataset.shipLength=2,n.src=d,s.textContent="Destroyer";break;case"submarine":t.dataset.shipName="submarine",t.dataset.shipLength=3,n.src=i,s.textContent="Submarine";break;default:t.dataset.shipName="battleship",t.dataset.shipLength=4,n.src=r,s.textContent="Battleship"}return a.appendChild(n),a.appendChild(s),t.appendChild(a),t})(t);a.draggable="true",e.appendChild(a)})),e})()),e.querySelector("#board-setup").appendChild((()=>{const e=document.createElement("div");e.id="axis-button-container",e.className="axis-button-container";const t=document.createElement("button");t.id="x-button",t.classList.add("axis-button","selected"),t.className="axis-button",t.textContent="X Axis";const a=document.createElement("button");return a.id="y-button",a.className="axis-button",a.textContent="Y Axis",e.appendChild(t),e.appendChild(a),e})()),e};return{loadSetupMaterial:()=>{const e=document.getElementById("app");e.classList="",e.classList.add("app","setup"),e.appendChild((()=>{const e=document.createElement("div");return e.id="setup-container",e.className="setup-container",e.appendChild(n()),e})()),e.appendChild((()=>{const e=document.createElement("section");e.id="reset-continue-section",e.className="reset-continue-section";const t=document.createElement("button");t.className="reset-button",t.id="reset-button",t.textContent="Reset";const a=document.createElement("button");return a.className="continue-button",a.id="continue-button",a.textContent="Continue",e.appendChild(t),e.appendChild(a),e})()),a()}}})(),b=g,f=(()=>{let e=[];const t=()=>{e=[]},a=()=>{const a=document.getElementById("field-container");for(let t=0;t<e.length;t+=1)a.children[e[t]].className="field";t()};return{draggableFields:()=>{document.getElementById("fleet-setup").childNodes.forEach((e=>{e.addEventListener("dragstart",(()=>{m.state.getPlayer().getMap().setShipOnDrag({name:e.dataset.shipName,length:e.dataset.shipLength})}))})),document.getElementById("field-container").childNodes.forEach((e=>{e.addEventListener("dragenter",(e=>{e.preventDefault()}))})),(()=>{const a=document.getElementById("field-container");a.childNodes.forEach(((n,r)=>{n.addEventListener("dragover",(n=>{n.preventDefault(),((a,n)=>{const r=m.state.getPlayer().getMap(),c=r.getBoard(),o=r.getAxis(),d=r.getshipOnDrag();let{length:i}=d;t();let l=!1;if("X"===o)for(let t=n;t<s.nearestTen(n+1);t+=1){const[n,r]=s.getCoordinates(t);if(0===i)break;a.children[t].classList.add("hovering"),e.push(t),i-=1,"x"!==c[n][r]&&(l=!0)}if("Y"===o)for(let t=n;t<100;t+=10){const[n,r]=s.getCoordinates(t);if(0===i)break;a.children[t].classList.add("hovering"),e.push(t),i-=1,"x"!==c[n][r]&&(l=!0)}(l||0!==i)&&e.forEach((e=>{a.children[e].classList.add("red")}))})(a,r)}))}))})(),document.getElementById("field-container").childNodes.forEach((e=>{e.addEventListener("dragleave",(()=>{a()}))})),document.getElementById("field-container").childNodes.forEach(((e,t)=>{e.addEventListener("drop",(()=>{console.log(m.state.getPlayer().getMap().getBoard());const[e,n]=s.getCoordinates(t),[r,c]=((e,t)=>{const a=m.getState().getPlayer().getMap(),n=m.getState().getPlayer().getMap().getshipOnDrag();return"X"===a.getAxis()?[a.placeX(l(n.name,n.length),e,t),n.name]:[a.placeY(l(n.name,n.length),e,t),n.name]})(e,n);a(),h.loadFleet(),((e,t)=>{e&&document.querySelector(`[data-ship-name=${t.name}]`).classList.add("hidden")})(r,c)}))}))}}})();(()=>{const e=m.initializeGame(),t={carrier:!1,battleship:!1},a={name:"",length:""},r=()=>{s.deleteContent(),b.loadSetupMaterial(),console.log(e.player.getMap()),f.draggableFields(a,t,e.player.getMap())};return{loadContent:()=>{n.loadCard(),document.getElementById("play-button").addEventListener("click",r)}}})().loadContent()}},e=>{e(e.s=308)}]);